import matplotlib.path as mplPath
import numpy as np
import pandas as pd
from shapely.geometry import Point
from shapely.geometry.polygon import Polygon
x1 = Polygon(np.array([[42.41522747	,-85.37042531]	,	[42.41522954,	-85.36926933]	,	[42.41424009	,-85.36925157]		,[42.41420903	,-85.37042229]]))
x2 = Polygon(np.array([[42.41524124	,-85.3692239],
                                    [42.41523408,	-85.36811521],
                                    [42.41423443, -85.36808022],
                                    [42.41422394,-85.36920635]])) 
x3 = Polygon(np.array([[42.41419118,-85.37156693],
                                    [42.41419415,-85.37044564],
                                    [42.4132009,-85.37042297],
                                    [42.41318977,-85.37156474]])) 
x4 = Polygon(np.array([[42.4142087,-85.36924173],
                                    [42.41419966,-85.3680937],
                                    [42.41321188,-85.36806708],
                                    [42.41320905,-85.36924128]])) 
x5 = Polygon(np.array([[42.41314979 , -85.37273396],
                                    [42.41316101,-85.37158636],
                                    [42.41215697,-85.37157097],
                                    [42.41215435,-85.37272006]])) 
x6 = Polygon(np.array([[42.4131571,  -85.37155145],
                                    [42.41316945,-85.37042241],
                                    [42.41217156, -85.3704041 ],
                                    [42.41216125,-85.37153285]]))
x7 = Polygon(np.array([[42.4131827,  -85.37038567],
                                    [42.41318889,-85.36926528],
                                    [42.41218326,-85.36922451],
                                    [42.41218051,-85.37035868]]))
x8 = Polygon(np.array([[42.41317999 , -85.36921302],
                                    [42.41318622,-85.36805956],
                                    [42.41219835,-85.36803246],
                                    [42.41219514, -85.3692027]])) 
x9 = Polygon(np.array([[42.41213523,  -85.37157102],
                                    [42.41214955,-85.37038421],
                                    [42.41114206,-85.37035595],
                                    [42.41113128,-85.37151277]]))   
x10 = Polygon(np.array([[42.4121511 , -85.37035585],
                                    [42.4121597,-85.36921898],
                                    [42.41116274,-85.36919817],
                                    [42.41115401,-85.37033258]]))                                                                                                   
x11 = Polygon(np.array([[42.41216625 , -85.36918941],
                                    [42.41217049,-85.3680517],
                                    [42.41116722,-85.36803269],
                                    [42.41116147,-85.36916792]]))  
x12 = Polygon(np.array([[42.41111051,  -85.37154401],
                                    [42.41112657,-85.37037366],
                                    [42.410141,-85.37035707],
                                    [42.41013702,-85.37151585]]))
x13 = Polygon(np.array([[42.41113373 , -85.36918855],
                                    [42.41113738,-85.36803832],
                                    [42.41016354,-85.36802033],
                                    [42.41015204,-85.36917486]])) 
x14 = Polygon(np.array([[42.41013018, -85.37512295],
                                    [42.41014108, -85.37398495],
                                    [42.40912652, -85.37394276],
                                    [42.4091171, -85.37512477]]))
x15 = Polygon(np.array([[42.41009543,  -85.37265799],
                                    [42.41010085, -85.37152506],
                                    [42.4090821, -85.37149435],
                                    [42.40908252, -85.37265009]])) 

x16 = Polygon(np.array([[42.41011272, -85.36916692],
                                    [42.41012645, -85.36801992],
                                    [42.40912957, -85.36799415],
                                    [42.40911514, -85.36913608]])) 

x17 = Polygon(np.array([[42.40909393, -85.3762939],
                                    [42.40910211, -85.37515393],
                                    [42.40809521, -85.37511837],
                                    [42.40807866, -85.37627273]]))
x18 = Polygon(np.array([[42.40905822, -85.37265881],
                                    [42.40906514, -85.37148654],
                                    [42.40806213, -85.37147632],
                                    [42.40804439, -85.3726506]]))
x19 = Polygon(np.array([[42.40907962, -85.37146185],
                                    [42.40908903, -85.37033575],
                                    [42.40807652, -85.37030702],
                                    [42.4080511, -85.37145739]]))

x20 = Polygon(np.array([[42.40909531, -85.37030266],
                                    [42.409097, -85.36914746],
                                    [42.40808775, -85.36914172],
                                    [42.40807191, -85.37028746]]))
x21 = Polygon(np.array([[42.40806005, -85.37744329],
                                    [42.40806607, -85.37628458],
                                    [42.40706917, -85.3762717],
                                    [42.40706311, -85.37745033]]))
x22 = Polygon(np.array([[42.40805908, -85.37626016],
                                    [42.40806875, -85.37511863],
                                    [42.40707025, -85.37509479],
                                    [42.40706224, -85.37624153]]))
x23 = Polygon(np.array([[42.40801942, -85.37265763],
                                    [42.40803656, -85.37145213],
                                    [42.40701661, -85.37145775],
                                    [42.40700251, -85.37264127]]))
x24 = Polygon(np.array([[42.40703015, -85.37028137],
                                    [42.40704591, -85.36912097],
                                    [42.40602395, -85.36909524],
                                    [42.40600702, -85.37028128]]))                                                                       

poly=[x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20,x21,x22,x23,x24]
count2=0
yieldTotal =np.zeros(24)
count =np.zeros(24)
result =np.zeros(24)
dataset=pd.read_excel(r"D:\Aruna\Sem 7\Project\Dataset\Kellogg-Michigan\yearwise data- lat-long-yield\2001_lat-long-yield.xlsx",nrows=32146)
latlong = dataset.iloc[:,[0,1]].values
yeild =dataset.iloc[:,[2]].values 
#point = Point(42.414843,-85.369686)
#if point.within(polygon):
#    print("hii")
#print(latlong[0][1])
#yieldTotal=0
for i in range(0,32145,1):
    point = Point(latlong[i][1],latlong[i][0])
    for j in range(0,24,1):
        if point.within(poly[j]):
            count[j]+=1
            yieldTotal[j]+=yeild[i][0]
for i in range(0,24,1):
    result[i]=yieldTotal[i]/count[i]
print(result)
#point = (, -85.37738389)
#print(point, " is in polygon: ", poly_path.contains_point(point))

#point = (1200, 1000)
#print(point, " is in polygon: ", poly_path.contains_point(point))